{"version":3,"file":"BitmapFont-DaWjdnSh.js","sources":["../../node_modules/pixi.js/lib/scene/text-bitmap/AbstractBitmapFont.mjs","../../node_modules/pixi.js/lib/scene/text-bitmap/DynamicBitmapFont.mjs","../../node_modules/pixi.js/lib/scene/text-bitmap/utils/getBitmapTextLayout.mjs","../../node_modules/pixi.js/lib/scene/text-bitmap/utils/resolveCharacters.mjs","../../node_modules/pixi.js/lib/scene/text-bitmap/BitmapFontManager.mjs","../../node_modules/pixi.js/lib/scene/text-bitmap/BitmapFont.mjs"],"sourcesContent":["import EventEmitter from 'eventemitter3';\nimport { deprecation, v8_0_0 } from '../../utils/logging/deprecation.mjs';\n\n\"use strict\";\nclass AbstractBitmapFont extends EventEmitter {\n  constructor() {\n    super(...arguments);\n    /** The map of characters by character code. */\n    this.chars = /* @__PURE__ */ Object.create(null);\n    /**\n     * The line-height of the font face in pixels.\n     * @type {number}\n     */\n    this.lineHeight = 0;\n    /**\n     * The name of the font face\n     * @type {string}\n     */\n    this.fontFamily = \"\";\n    /** The metrics of the font face. */\n    this.fontMetrics = { fontSize: 0, ascent: 0, descent: 0 };\n    /**\n     * The offset of the font face from the baseline.\n     * @type {number}\n     */\n    this.baseLineOffset = 0;\n    /** The range and type of the distance field for this font. */\n    this.distanceField = { type: \"none\", range: 0 };\n    /** The map of base page textures (i.e., sheets of glyphs). */\n    this.pages = [];\n    /** should the fill for this font be applied as a tint to the text. */\n    this.applyFillAsTint = true;\n    /** The size of the font face in pixels. */\n    this.baseMeasurementFontSize = 100;\n    this.baseRenderedFontSize = 100;\n  }\n  /**\n   * The name of the font face.\n   * @deprecated since 8.0.0 Use `fontFamily` instead.\n   */\n  get font() {\n    deprecation(v8_0_0, \"BitmapFont.font is deprecated, please use BitmapFont.fontFamily instead.\");\n    return this.fontFamily;\n  }\n  /**\n   * The map of base page textures (i.e., sheets of glyphs).\n   * @deprecated since 8.0.0 Use `pages` instead.\n   */\n  get pageTextures() {\n    deprecation(v8_0_0, \"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead.\");\n    return this.pages;\n  }\n  /**\n   * The size of the font face in pixels.\n   * @deprecated since 8.0.0 Use `fontMetrics.fontSize` instead.\n   */\n  get size() {\n    deprecation(v8_0_0, \"BitmapFont.size is deprecated, please use BitmapFont.fontMetrics.fontSize instead.\");\n    return this.fontMetrics.fontSize;\n  }\n  /**\n   * The kind of distance field for this font or \"none\".\n   * @deprecated since 8.0.0 Use `distanceField.type` instead.\n   */\n  get distanceFieldRange() {\n    deprecation(v8_0_0, \"BitmapFont.distanceFieldRange is deprecated, please use BitmapFont.distanceField.range instead.\");\n    return this.distanceField.range;\n  }\n  /**\n   * The range of the distance field in pixels.\n   * @deprecated since 8.0.0 Use `distanceField.range` instead.\n   */\n  get distanceFieldType() {\n    deprecation(v8_0_0, \"BitmapFont.distanceFieldType is deprecated, please use BitmapFont.distanceField.type instead.\");\n    return this.distanceField.type;\n  }\n  destroy(destroyTextures = false) {\n    this.emit(\"destroy\", this);\n    this.removeAllListeners();\n    for (const i in this.chars) {\n      this.chars[i].texture?.destroy();\n    }\n    this.chars = null;\n    if (destroyTextures) {\n      this.pages.forEach((page) => page.texture.destroy(true));\n      this.pages = null;\n    }\n  }\n}\n\nexport { AbstractBitmapFont };\n//# sourceMappingURL=AbstractBitmapFont.mjs.map\n","import { Color } from '../../color/Color.mjs';\nimport { Rectangle } from '../../maths/shapes/Rectangle.mjs';\nimport { CanvasPool } from '../../rendering/renderers/shared/texture/CanvasPool.mjs';\nimport { ImageSource } from '../../rendering/renderers/shared/texture/sources/ImageSource.mjs';\nimport { Texture } from '../../rendering/renderers/shared/texture/Texture.mjs';\nimport { TextureStyle } from '../../rendering/renderers/shared/texture/TextureStyle.mjs';\nimport { deprecation, v8_0_0 } from '../../utils/logging/deprecation.mjs';\nimport { CanvasTextMetrics } from '../text/canvas/CanvasTextMetrics.mjs';\nimport { fontStringFromTextStyle } from '../text/canvas/utils/fontStringFromTextStyle.mjs';\nimport { getCanvasFillStyle } from '../text/canvas/utils/getCanvasFillStyle.mjs';\nimport { TextStyle } from '../text/TextStyle.mjs';\nimport { AbstractBitmapFont } from './AbstractBitmapFont.mjs';\n\n\"use strict\";\nconst _DynamicBitmapFont = class _DynamicBitmapFont extends AbstractBitmapFont {\n  /**\n   * @param options - The options for the dynamic bitmap font.\n   */\n  constructor(options) {\n    super();\n    /**\n     * this is a resolution modifier for the font size..\n     * texture resolution will also be used to scale texture according to its font size also\n     */\n    this.resolution = 1;\n    /** The pages of the font. */\n    this.pages = [];\n    this._padding = 0;\n    this._measureCache = /* @__PURE__ */ Object.create(null);\n    this._currentChars = [];\n    this._currentX = 0;\n    this._currentY = 0;\n    this._currentMaxCharHeight = 0;\n    this._currentPageIndex = -1;\n    this._skipKerning = false;\n    const dynamicOptions = { ..._DynamicBitmapFont.defaultOptions, ...options };\n    this._textureSize = dynamicOptions.textureSize;\n    this._mipmap = dynamicOptions.mipmap;\n    const style = dynamicOptions.style.clone();\n    if (dynamicOptions.overrideFill) {\n      style._fill.color = 16777215;\n      style._fill.alpha = 1;\n      style._fill.texture = Texture.WHITE;\n      style._fill.fill = null;\n    }\n    this.applyFillAsTint = dynamicOptions.overrideFill;\n    const requestedFontSize = style.fontSize;\n    style.fontSize = this.baseMeasurementFontSize;\n    const font = fontStringFromTextStyle(style);\n    if (dynamicOptions.overrideSize) {\n      if (style._stroke) {\n        style._stroke.width *= this.baseRenderedFontSize / requestedFontSize;\n      }\n    } else {\n      style.fontSize = this.baseRenderedFontSize = requestedFontSize;\n    }\n    this._style = style;\n    this._skipKerning = dynamicOptions.skipKerning ?? false;\n    this.resolution = dynamicOptions.resolution ?? 1;\n    this._padding = dynamicOptions.padding ?? 4;\n    if (dynamicOptions.textureStyle) {\n      this._textureStyle = dynamicOptions.textureStyle instanceof TextureStyle ? dynamicOptions.textureStyle : new TextureStyle(dynamicOptions.textureStyle);\n    }\n    this.fontMetrics = CanvasTextMetrics.measureFont(font);\n    this.lineHeight = style.lineHeight || this.fontMetrics.fontSize || style.fontSize;\n  }\n  ensureCharacters(chars) {\n    const charList = CanvasTextMetrics.graphemeSegmenter(chars).filter((char) => !this._currentChars.includes(char)).filter((char, index, self) => self.indexOf(char) === index);\n    if (!charList.length) return;\n    this._currentChars = [...this._currentChars, ...charList];\n    let pageData;\n    if (this._currentPageIndex === -1) {\n      pageData = this._nextPage();\n    } else {\n      pageData = this.pages[this._currentPageIndex];\n    }\n    let { canvas, context } = pageData.canvasAndContext;\n    let textureSource = pageData.texture.source;\n    const style = this._style;\n    let currentX = this._currentX;\n    let currentY = this._currentY;\n    let currentMaxCharHeight = this._currentMaxCharHeight;\n    const fontScale = this.baseRenderedFontSize / this.baseMeasurementFontSize;\n    const padding = this._padding * fontScale;\n    let skipTexture = false;\n    const maxTextureWidth = canvas.width / this.resolution;\n    const maxTextureHeight = canvas.height / this.resolution;\n    for (let i = 0; i < charList.length; i++) {\n      const char = charList[i];\n      const metrics = CanvasTextMetrics.measureText(char, style, canvas, false);\n      metrics.lineHeight = metrics.height;\n      const width = metrics.width * fontScale;\n      const textureGlyphWidth = Math.ceil((style.fontStyle === \"italic\" ? 2 : 1) * width);\n      const height = metrics.height * fontScale;\n      const paddedWidth = textureGlyphWidth + padding * 2;\n      const paddedHeight = height + padding * 2;\n      skipTexture = false;\n      if (char !== \"\\n\" && char !== \"\\r\" && char !== \"\t\" && char !== \" \") {\n        skipTexture = true;\n        currentMaxCharHeight = Math.ceil(Math.max(paddedHeight, currentMaxCharHeight));\n      }\n      if (currentX + paddedWidth > maxTextureWidth) {\n        currentY += currentMaxCharHeight;\n        currentMaxCharHeight = paddedHeight;\n        currentX = 0;\n        if (currentY + currentMaxCharHeight > maxTextureHeight) {\n          textureSource.update();\n          const pageData2 = this._nextPage();\n          canvas = pageData2.canvasAndContext.canvas;\n          context = pageData2.canvasAndContext.context;\n          textureSource = pageData2.texture.source;\n          currentX = 0;\n          currentY = 0;\n          currentMaxCharHeight = 0;\n        }\n      }\n      const xAdvance = width / fontScale - (style.dropShadow?.distance ?? 0) - (style._stroke?.width ?? 0);\n      this.chars[char] = {\n        id: char.codePointAt(0),\n        xOffset: -this._padding,\n        yOffset: -this._padding,\n        xAdvance,\n        kerning: {}\n      };\n      if (skipTexture) {\n        this._drawGlyph(\n          context,\n          metrics,\n          currentX + padding,\n          currentY + padding,\n          fontScale,\n          style\n        );\n        const px = textureSource.width * fontScale;\n        const py = textureSource.height * fontScale;\n        const frame = new Rectangle(\n          currentX / px * textureSource.width,\n          currentY / py * textureSource.height,\n          paddedWidth / px * textureSource.width,\n          paddedHeight / py * textureSource.height\n        );\n        this.chars[char].texture = new Texture({\n          source: textureSource,\n          frame\n        });\n        currentX += Math.ceil(paddedWidth);\n      }\n    }\n    textureSource.update();\n    this._currentX = currentX;\n    this._currentY = currentY;\n    this._currentMaxCharHeight = currentMaxCharHeight;\n    this._skipKerning && this._applyKerning(charList, context);\n  }\n  /**\n   * @deprecated since 8.0.0\n   * The map of base page textures (i.e., sheets of glyphs).\n   */\n  get pageTextures() {\n    deprecation(v8_0_0, \"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead.\");\n    return this.pages;\n  }\n  _applyKerning(newChars, context) {\n    const measureCache = this._measureCache;\n    for (let i = 0; i < newChars.length; i++) {\n      const first = newChars[i];\n      for (let j = 0; j < this._currentChars.length; j++) {\n        const second = this._currentChars[j];\n        let c1 = measureCache[first];\n        if (!c1) c1 = measureCache[first] = context.measureText(first).width;\n        let c2 = measureCache[second];\n        if (!c2) c2 = measureCache[second] = context.measureText(second).width;\n        let total = context.measureText(first + second).width;\n        let amount = total - (c1 + c2);\n        if (amount) {\n          this.chars[first].kerning[second] = amount;\n        }\n        total = context.measureText(first + second).width;\n        amount = total - (c1 + c2);\n        if (amount) {\n          this.chars[second].kerning[first] = amount;\n        }\n      }\n    }\n  }\n  _nextPage() {\n    this._currentPageIndex++;\n    const textureResolution = this.resolution;\n    const canvasAndContext = CanvasPool.getOptimalCanvasAndContext(\n      this._textureSize,\n      this._textureSize,\n      textureResolution\n    );\n    this._setupContext(canvasAndContext.context, this._style, textureResolution);\n    const resolution = textureResolution * (this.baseRenderedFontSize / this.baseMeasurementFontSize);\n    const texture = new Texture({\n      source: new ImageSource({\n        resource: canvasAndContext.canvas,\n        resolution,\n        alphaMode: \"premultiply-alpha-on-upload\",\n        autoGenerateMipmaps: this._mipmap\n      })\n    });\n    if (this._textureStyle) {\n      texture.source.style = this._textureStyle;\n    }\n    const pageData = {\n      canvasAndContext,\n      texture\n    };\n    this.pages[this._currentPageIndex] = pageData;\n    return pageData;\n  }\n  // canvas style!\n  _setupContext(context, style, resolution) {\n    style.fontSize = this.baseRenderedFontSize;\n    context.scale(resolution, resolution);\n    context.font = fontStringFromTextStyle(style);\n    style.fontSize = this.baseMeasurementFontSize;\n    context.textBaseline = style.textBaseline;\n    const stroke = style._stroke;\n    const strokeThickness = stroke?.width ?? 0;\n    if (stroke) {\n      context.lineWidth = strokeThickness;\n      context.lineJoin = stroke.join;\n      context.miterLimit = stroke.miterLimit;\n      context.strokeStyle = getCanvasFillStyle(stroke, context);\n    }\n    if (style._fill) {\n      context.fillStyle = getCanvasFillStyle(style._fill, context);\n    }\n    if (style.dropShadow) {\n      const shadowOptions = style.dropShadow;\n      const rgb = Color.shared.setValue(shadowOptions.color).toArray();\n      const dropShadowBlur = shadowOptions.blur * resolution;\n      const dropShadowDistance = shadowOptions.distance * resolution;\n      context.shadowColor = `rgba(${rgb[0] * 255},${rgb[1] * 255},${rgb[2] * 255},${shadowOptions.alpha})`;\n      context.shadowBlur = dropShadowBlur;\n      context.shadowOffsetX = Math.cos(shadowOptions.angle) * dropShadowDistance;\n      context.shadowOffsetY = Math.sin(shadowOptions.angle) * dropShadowDistance;\n    } else {\n      context.shadowColor = \"black\";\n      context.shadowBlur = 0;\n      context.shadowOffsetX = 0;\n      context.shadowOffsetY = 0;\n    }\n  }\n  _drawGlyph(context, metrics, x, y, fontScale, style) {\n    const char = metrics.text;\n    const fontProperties = metrics.fontProperties;\n    const stroke = style._stroke;\n    const strokeThickness = (stroke?.width ?? 0) * fontScale;\n    const tx = x + strokeThickness / 2;\n    const ty = y - strokeThickness / 2;\n    const descent = fontProperties.descent * fontScale;\n    const lineHeight = metrics.lineHeight * fontScale;\n    let removeShadow = false;\n    if (style.stroke && strokeThickness) {\n      removeShadow = true;\n      context.strokeText(char, tx, ty + lineHeight - descent);\n    }\n    const { shadowBlur, shadowOffsetX, shadowOffsetY } = context;\n    if (style._fill) {\n      if (removeShadow) {\n        context.shadowBlur = 0;\n        context.shadowOffsetX = 0;\n        context.shadowOffsetY = 0;\n      }\n      context.fillText(char, tx, ty + lineHeight - descent);\n    }\n    if (removeShadow) {\n      context.shadowBlur = shadowBlur;\n      context.shadowOffsetX = shadowOffsetX;\n      context.shadowOffsetY = shadowOffsetY;\n    }\n  }\n  destroy() {\n    super.destroy();\n    for (let i = 0; i < this.pages.length; i++) {\n      const { canvasAndContext, texture } = this.pages[i];\n      CanvasPool.returnCanvasAndContext(canvasAndContext);\n      texture.destroy(true);\n    }\n    this.pages = null;\n  }\n};\n_DynamicBitmapFont.defaultOptions = {\n  textureSize: 512,\n  style: new TextStyle(),\n  mipmap: true\n};\nlet DynamicBitmapFont = _DynamicBitmapFont;\n\nexport { DynamicBitmapFont };\n//# sourceMappingURL=DynamicBitmapFont.mjs.map\n","\"use strict\";\nfunction getBitmapTextLayout(chars, style, font, trimEnd) {\n  const layoutData = {\n    width: 0,\n    height: 0,\n    offsetY: 0,\n    scale: style.fontSize / font.baseMeasurementFontSize,\n    lines: [{\n      width: 0,\n      charPositions: [],\n      spaceWidth: 0,\n      spacesIndex: [],\n      chars: []\n    }]\n  };\n  layoutData.offsetY = font.baseLineOffset;\n  let currentLine = layoutData.lines[0];\n  let previousChar = null;\n  let firstWord = true;\n  const currentWord = {\n    spaceWord: false,\n    width: 0,\n    start: 0,\n    index: 0,\n    // use index to not modify the array as we use it a lot!\n    positions: [],\n    chars: []\n  };\n  const scale = font.baseMeasurementFontSize / style.fontSize;\n  const adjustedLetterSpacing = style.letterSpacing * scale;\n  const adjustedWordWrapWidth = style.wordWrapWidth * scale;\n  const adjustedLineHeight = style.lineHeight ? style.lineHeight * scale : font.lineHeight;\n  const breakWords = style.wordWrap && style.breakWords;\n  const nextWord = (word) => {\n    const start = currentLine.width;\n    for (let j = 0; j < currentWord.index; j++) {\n      const position = word.positions[j];\n      currentLine.chars.push(word.chars[j]);\n      currentLine.charPositions.push(position + start);\n    }\n    currentLine.width += word.width;\n    firstWord = false;\n    currentWord.width = 0;\n    currentWord.index = 0;\n    currentWord.chars.length = 0;\n  };\n  const nextLine = () => {\n    let index = currentLine.chars.length - 1;\n    if (trimEnd) {\n      let lastChar = currentLine.chars[index];\n      while (lastChar === \" \") {\n        currentLine.width -= font.chars[lastChar].xAdvance;\n        lastChar = currentLine.chars[--index];\n      }\n    }\n    layoutData.width = Math.max(layoutData.width, currentLine.width);\n    currentLine = {\n      width: 0,\n      charPositions: [],\n      chars: [],\n      spaceWidth: 0,\n      spacesIndex: []\n    };\n    firstWord = true;\n    layoutData.lines.push(currentLine);\n    layoutData.height += adjustedLineHeight;\n  };\n  const checkIsOverflow = (lineWidth) => lineWidth - adjustedLetterSpacing > adjustedWordWrapWidth;\n  for (let i = 0; i < chars.length + 1; i++) {\n    let char;\n    const isEnd = i === chars.length;\n    if (!isEnd) {\n      char = chars[i];\n    }\n    const charData = font.chars[char] || font.chars[\" \"];\n    const isSpace = /(?:\\s)/.test(char);\n    const isWordBreak = isSpace || char === \"\\r\" || char === \"\\n\" || isEnd;\n    if (isWordBreak) {\n      const addWordToNextLine = !firstWord && style.wordWrap && checkIsOverflow(currentLine.width + currentWord.width);\n      if (addWordToNextLine) {\n        nextLine();\n        nextWord(currentWord);\n        if (!isEnd) {\n          currentLine.charPositions.push(0);\n        }\n      } else {\n        currentWord.start = currentLine.width;\n        nextWord(currentWord);\n        if (!isEnd) {\n          currentLine.charPositions.push(0);\n        }\n      }\n      if (char === \"\\r\" || char === \"\\n\") {\n        nextLine();\n      } else if (!isEnd) {\n        const spaceWidth = charData.xAdvance + (charData.kerning[previousChar] || 0) + adjustedLetterSpacing;\n        currentLine.width += spaceWidth;\n        currentLine.spaceWidth = spaceWidth;\n        currentLine.spacesIndex.push(currentLine.charPositions.length);\n        currentLine.chars.push(char);\n      }\n    } else {\n      const kerning = charData.kerning[previousChar] || 0;\n      const nextCharWidth = charData.xAdvance + kerning + adjustedLetterSpacing;\n      const addWordToNextLine = breakWords && checkIsOverflow(currentLine.width + currentWord.width + nextCharWidth);\n      if (addWordToNextLine) {\n        nextWord(currentWord);\n        nextLine();\n      }\n      currentWord.positions[currentWord.index++] = currentWord.width + kerning;\n      currentWord.chars.push(char);\n      currentWord.width += nextCharWidth;\n    }\n    previousChar = char;\n  }\n  nextLine();\n  if (style.align === \"center\") {\n    alignCenter(layoutData);\n  } else if (style.align === \"right\") {\n    alignRight(layoutData);\n  } else if (style.align === \"justify\") {\n    alignJustify(layoutData);\n  }\n  return layoutData;\n}\nfunction alignCenter(measurementData) {\n  for (let i = 0; i < measurementData.lines.length; i++) {\n    const line = measurementData.lines[i];\n    const offset = measurementData.width / 2 - line.width / 2;\n    for (let j = 0; j < line.charPositions.length; j++) {\n      line.charPositions[j] += offset;\n    }\n  }\n}\nfunction alignRight(measurementData) {\n  for (let i = 0; i < measurementData.lines.length; i++) {\n    const line = measurementData.lines[i];\n    const offset = measurementData.width - line.width;\n    for (let j = 0; j < line.charPositions.length; j++) {\n      line.charPositions[j] += offset;\n    }\n  }\n}\nfunction alignJustify(measurementData) {\n  const width = measurementData.width;\n  for (let i = 0; i < measurementData.lines.length; i++) {\n    const line = measurementData.lines[i];\n    let indy = 0;\n    let spaceIndex = line.spacesIndex[indy++];\n    let offset = 0;\n    const totalSpaces = line.spacesIndex.length;\n    const newSpaceWidth = (width - line.width) / totalSpaces;\n    const spaceWidth = newSpaceWidth;\n    for (let j = 0; j < line.charPositions.length; j++) {\n      if (j === spaceIndex) {\n        spaceIndex = line.spacesIndex[indy++];\n        offset += spaceWidth;\n      }\n      line.charPositions[j] += offset;\n    }\n  }\n}\n\nexport { getBitmapTextLayout };\n//# sourceMappingURL=getBitmapTextLayout.mjs.map\n","\"use strict\";\nfunction resolveCharacters(chars) {\n  if (chars === \"\") {\n    return [];\n  }\n  if (typeof chars === \"string\") {\n    chars = [chars];\n  }\n  const result = [];\n  for (let i = 0, j = chars.length; i < j; i++) {\n    const item = chars[i];\n    if (Array.isArray(item)) {\n      if (item.length !== 2) {\n        throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${item.length}.`);\n      }\n      if (item[0].length === 0 || item[1].length === 0) {\n        throw new Error(\"[BitmapFont]: Invalid character delimiter.\");\n      }\n      const startCode = item[0].charCodeAt(0);\n      const endCode = item[1].charCodeAt(0);\n      if (endCode < startCode) {\n        throw new Error(\"[BitmapFont]: Invalid character range.\");\n      }\n      for (let i2 = startCode, j2 = endCode; i2 <= j2; i2++) {\n        result.push(String.fromCharCode(i2));\n      }\n    } else {\n      result.push(...Array.from(item));\n    }\n  }\n  if (result.length === 0) {\n    throw new Error(\"[BitmapFont]: Empty set when resolving characters.\");\n  }\n  return result;\n}\n\nexport { resolveCharacters };\n//# sourceMappingURL=resolveCharacters.mjs.map\n","import { lru } from 'tiny-lru';\nimport { Cache } from '../../assets/cache/Cache.mjs';\nimport { deprecation, v8_0_0 } from '../../utils/logging/deprecation.mjs';\nimport { warn } from '../../utils/logging/warn.mjs';\nimport { CanvasTextMetrics } from '../text/canvas/CanvasTextMetrics.mjs';\nimport { TextStyle } from '../text/TextStyle.mjs';\nimport { DynamicBitmapFont } from './DynamicBitmapFont.mjs';\nimport { getBitmapTextLayout } from './utils/getBitmapTextLayout.mjs';\nimport { resolveCharacters } from './utils/resolveCharacters.mjs';\n\n\"use strict\";\nlet fontCount = 0;\nclass BitmapFontManagerClass {\n  constructor() {\n    /**\n     * This character set includes all the letters in the alphabet (both lower- and upper- case).\n     * @type {string[][]}\n     * @example\n     * BitmapFont.from('ExampleFont', style, { chars: BitmapFont.ALPHA })\n     */\n    this.ALPHA = [[\"a\", \"z\"], [\"A\", \"Z\"], \" \"];\n    /**\n     * This character set includes all decimal digits (from 0 to 9).\n     * @type {string[][]}\n     * @example\n     * BitmapFont.from('ExampleFont', style, { chars: BitmapFont.NUMERIC })\n     */\n    this.NUMERIC = [[\"0\", \"9\"]];\n    /**\n     * This character set is the union of `BitmapFont.ALPHA` and `BitmapFont.NUMERIC`.\n     * @type {string[][]}\n     */\n    this.ALPHANUMERIC = [[\"a\", \"z\"], [\"A\", \"Z\"], [\"0\", \"9\"], \" \"];\n    /**\n     * This character set consists of all the ASCII table.\n     * @type {string[][]}\n     * @see http://www.asciitable.com/\n     */\n    this.ASCII = [[\" \", \"~\"]];\n    /** Default options for installing a new BitmapFont. */\n    this.defaultOptions = {\n      chars: this.ALPHANUMERIC,\n      resolution: 1,\n      padding: 4,\n      skipKerning: false,\n      textureStyle: null\n    };\n    /** Cache for measured text layouts to avoid recalculating them multiple times. */\n    this.measureCache = lru(1e3);\n  }\n  /**\n   * Get a font for the specified text and style.\n   * @param text - The text to get the font for\n   * @param style - The style to use\n   */\n  getFont(text, style) {\n    let fontFamilyKey = `${style.fontFamily}-bitmap`;\n    let overrideFill = true;\n    if (style._fill.fill && !style._stroke) {\n      fontFamilyKey += style._fill.fill.styleKey;\n      overrideFill = false;\n    } else if (style._stroke || style.dropShadow) {\n      fontFamilyKey = `${style.styleKey}-bitmap`;\n      overrideFill = false;\n    }\n    if (!Cache.has(fontFamilyKey)) {\n      const styleCopy = Object.create(style);\n      styleCopy._lineHeight = 0;\n      const fnt = new DynamicBitmapFont({\n        style: styleCopy,\n        overrideFill,\n        overrideSize: true,\n        ...this.defaultOptions\n      });\n      fontCount++;\n      if (fontCount > 50) {\n        warn(\"BitmapText\", `You have dynamically created ${fontCount} bitmap fonts, this can be inefficient. Try pre installing your font styles using \\`BitmapFont.install({name:\"style1\", style})\\``);\n      }\n      fnt.once(\"destroy\", () => {\n        fontCount--;\n        Cache.remove(fontFamilyKey);\n      });\n      Cache.set(\n        fontFamilyKey,\n        fnt\n      );\n    }\n    const dynamicFont = Cache.get(fontFamilyKey);\n    dynamicFont.ensureCharacters?.(text);\n    return dynamicFont;\n  }\n  /**\n   * Get the layout of a text for the specified style.\n   * @param text - The text to get the layout for\n   * @param style - The style to use\n   * @param trimEnd - Whether to ignore whitespaces at the end of each line\n   */\n  getLayout(text, style, trimEnd = true) {\n    const bitmapFont = this.getFont(text, style);\n    const id = `${text}-${style.styleKey}-${trimEnd}`;\n    if (this.measureCache.has(id)) {\n      return this.measureCache.get(id);\n    }\n    const segments = CanvasTextMetrics.graphemeSegmenter(text);\n    const layoutData = getBitmapTextLayout(segments, style, bitmapFont, trimEnd);\n    this.measureCache.set(id, layoutData);\n    return layoutData;\n  }\n  /**\n   * Measure the text using the specified style.\n   * @param text - The text to measure\n   * @param style - The style to use\n   * @param trimEnd - Whether to ignore whitespaces at the end of each line\n   */\n  measureText(text, style, trimEnd = true) {\n    return this.getLayout(text, style, trimEnd);\n  }\n  // eslint-disable-next-line max-len\n  install(...args) {\n    let options = args[0];\n    if (typeof options === \"string\") {\n      options = {\n        name: options,\n        style: args[1],\n        chars: args[2]?.chars,\n        resolution: args[2]?.resolution,\n        padding: args[2]?.padding,\n        skipKerning: args[2]?.skipKerning\n      };\n      deprecation(v8_0_0, \"BitmapFontManager.install(name, style, options) is deprecated, use BitmapFontManager.install({name, style, ...options})\");\n    }\n    const name = options?.name;\n    if (!name) {\n      throw new Error(\"[BitmapFontManager] Property `name` is required.\");\n    }\n    options = { ...this.defaultOptions, ...options };\n    const textStyle = options.style;\n    const style = textStyle instanceof TextStyle ? textStyle : new TextStyle(textStyle);\n    const overrideFill = options.dynamicFill ?? this._canUseTintForStyle(style);\n    const font = new DynamicBitmapFont({\n      style,\n      overrideFill,\n      skipKerning: options.skipKerning,\n      padding: options.padding,\n      resolution: options.resolution,\n      overrideSize: false,\n      textureStyle: options.textureStyle\n    });\n    const flatChars = resolveCharacters(options.chars);\n    font.ensureCharacters(flatChars.join(\"\"));\n    Cache.set(`${name}-bitmap`, font);\n    font.once(\"destroy\", () => Cache.remove(`${name}-bitmap`));\n    return font;\n  }\n  /**\n   * Uninstalls a bitmap font from the cache.\n   * @param {string} name - The name of the bitmap font to uninstall.\n   */\n  uninstall(name) {\n    const cacheKey = `${name}-bitmap`;\n    const font = Cache.get(cacheKey);\n    if (font) {\n      font.destroy();\n    }\n  }\n  /**\n   * Determines if a style can use tinting instead of baking colors into the bitmap.\n   * Tinting is more efficient as it allows reusing the same bitmap with different colors.\n   * @param style - The text style to evaluate\n   * @returns true if the style can use tinting, false if colors must be baked in\n   * @private\n   */\n  _canUseTintForStyle(style) {\n    return !style._stroke && (!style.dropShadow || style.dropShadow.color === 0) && !style._fill.fill && style._fill.color === 16777215;\n  }\n}\nconst BitmapFontManager = new BitmapFontManagerClass();\n\nexport { BitmapFontManager };\n//# sourceMappingURL=BitmapFontManager.mjs.map\n","import { groupD8 } from '../../maths/matrix/groupD8.mjs';\nimport { Rectangle } from '../../maths/shapes/Rectangle.mjs';\nimport { Texture } from '../../rendering/renderers/shared/texture/Texture.mjs';\nimport { AbstractBitmapFont } from './AbstractBitmapFont.mjs';\nimport { BitmapFontManager } from './BitmapFontManager.mjs';\n\n\"use strict\";\nclass BitmapFont extends AbstractBitmapFont {\n  constructor(options, url) {\n    super();\n    const { textures, data } = options;\n    Object.keys(data.pages).forEach((key) => {\n      const pageData = data.pages[parseInt(key, 10)];\n      const texture = textures[pageData.id];\n      this.pages.push({ texture });\n    });\n    Object.keys(data.chars).forEach((key) => {\n      const charData = data.chars[key];\n      const {\n        frame: textureFrame,\n        source: textureSource,\n        rotate: textureRotate\n      } = textures[charData.page];\n      const frame = groupD8.transformRectCoords(\n        charData,\n        textureFrame,\n        textureRotate,\n        new Rectangle()\n      );\n      const texture = new Texture({\n        frame,\n        orig: new Rectangle(0, 0, charData.width, charData.height),\n        source: textureSource,\n        rotate: textureRotate\n      });\n      this.chars[key] = {\n        id: key.codePointAt(0),\n        xOffset: charData.xOffset,\n        yOffset: charData.yOffset,\n        xAdvance: charData.xAdvance,\n        kerning: charData.kerning ?? {},\n        texture\n      };\n    });\n    this.baseRenderedFontSize = data.fontSize;\n    this.baseMeasurementFontSize = data.fontSize;\n    this.fontMetrics = {\n      ascent: 0,\n      descent: 0,\n      fontSize: data.fontSize\n    };\n    this.baseLineOffset = data.baseLineOffset;\n    this.lineHeight = data.lineHeight;\n    this.fontFamily = data.fontFamily;\n    this.distanceField = data.distanceField ?? {\n      type: \"none\",\n      range: 0\n    };\n    this.url = url;\n  }\n  /** Destroys the BitmapFont object. */\n  destroy() {\n    super.destroy();\n    for (let i = 0; i < this.pages.length; i++) {\n      const { texture } = this.pages[i];\n      texture.destroy(true);\n    }\n    this.pages = null;\n  }\n  /**\n   * Generates and installs a bitmap font with the specified options.\n   * The font will be cached and available for use in BitmapText objects.\n   * @param options - Setup options for font generation\n   * @returns Installed font instance\n   * @example\n   * ```ts\n   * // Install a basic font\n   * BitmapFont.install({\n   *     name: 'Title',\n   *     style: {\n   *         fontFamily: 'Arial',\n   *         fontSize: 32,\n   *         fill: '#ffffff'\n   *     }\n   * });\n   *\n   * // Install with advanced options\n   * BitmapFont.install({\n   *     name: 'Custom',\n   *     style: {\n   *         fontFamily: 'Arial',\n   *         fontSize: 24,\n   *         fill: '#00ff00',\n   *         stroke: { color: '#000000', width: 2 }\n   *     },\n   *     chars: [['a', 'z'], ['A', 'Z'], ['0', '9']],\n   *     resolution: 2,\n   *     padding: 4,\n   *     textureStyle: {\n   *         scaleMode: 'nearest'\n   *     }\n   * });\n   * ```\n   */\n  static install(options) {\n    BitmapFontManager.install(options);\n  }\n  /**\n   * Uninstalls a bitmap font from the cache.\n   * This frees up memory and resources associated with the font.\n   * @param name - The name of the bitmap font to uninstall\n   * @example\n   * ```ts\n   * // Remove a font when it's no longer needed\n   * BitmapFont.uninstall('MyCustomFont');\n   *\n   * // Clear multiple fonts\n   * ['Title', 'Heading', 'Body'].forEach(BitmapFont.uninstall);\n   * ```\n   */\n  static uninstall(name) {\n    BitmapFontManager.uninstall(name);\n  }\n}\n\nexport { BitmapFont };\n//# sourceMappingURL=BitmapFont.mjs.map\n"],"names":["AbstractBitmapFont","EventEmitter","deprecation","v8_0_0","destroyTextures","i","page","_DynamicBitmapFont","options","dynamicOptions","style","Texture","requestedFontSize","font","fontStringFromTextStyle","TextureStyle","CanvasTextMetrics","chars","charList","char","index","self","pageData","canvas","context","textureSource","currentX","currentY","currentMaxCharHeight","fontScale","padding","skipTexture","maxTextureWidth","maxTextureHeight","metrics","width","textureGlyphWidth","height","paddedWidth","paddedHeight","pageData2","xAdvance","px","py","frame","Rectangle","newChars","measureCache","first","j","second","c1","c2","total","amount","textureResolution","canvasAndContext","CanvasPool","resolution","texture","ImageSource","stroke","strokeThickness","getCanvasFillStyle","shadowOptions","rgb","Color","dropShadowBlur","dropShadowDistance","x","y","fontProperties","tx","ty","descent","lineHeight","removeShadow","shadowBlur","shadowOffsetX","shadowOffsetY","TextStyle","DynamicBitmapFont","getBitmapTextLayout","trimEnd","layoutData","currentLine","previousChar","firstWord","currentWord","scale","adjustedLetterSpacing","adjustedWordWrapWidth","adjustedLineHeight","breakWords","nextWord","word","start","position","nextLine","lastChar","checkIsOverflow","lineWidth","isEnd","charData","spaceWidth","kerning","nextCharWidth","alignCenter","alignRight","alignJustify","measurementData","line","offset","indy","spaceIndex","totalSpaces","resolveCharacters","result","item","startCode","endCode","i2","j2","fontCount","BitmapFontManagerClass","lru","text","fontFamilyKey","overrideFill","Cache","styleCopy","fnt","warn","dynamicFont","bitmapFont","id","segments","args","name","textStyle","flatChars","cacheKey","BitmapFontManager","BitmapFont","url","textures","data","key","textureFrame","textureRotate","groupD8"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5]}